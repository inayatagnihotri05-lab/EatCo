<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Climate Finance Simulator | EatCo</title>
<style>
  /* ---------- THEME ---------- */
  :root {
    --bg: #f9f9f9;
    --panel: #e8f5e9;
    --accent: #2e7d32;
    --muted: #555;
    --border: #c8e6c9;
    --danger: #c62828;
    font-family: 'Inter', sans-serif;
  }
  * { box-sizing: border-box; }
  body { margin:0; background:var(--bg); color:#111; }
  h3 { margin:0; color:var(--accent); }
  p { margin:0.25em 0; }
  button { cursor:pointer; }

  /* ---------- LAYOUT ---------- */
  .container { max-width: 1000px; margin:20px auto; display:flex; gap:20px; flex-wrap:wrap; }
  .panel { flex:1; min-width:280px; background:var(--panel); border:1px solid var(--border); border-radius:12px; padding:16px; }
  .panel h3 { margin-bottom:8px; }
  .stats { display:flex; gap:10px; flex-wrap:wrap; margin-bottom:12px; }
  .stat { flex:1; background:#fff; padding:10px; border-radius:8px; text-align:center; border:1px solid var(--border);}
  .stat .value { font-weight:700; font-size:1.2em; color:var(--accent); }

  /* ---------- INVESTMENTS ---------- */
  .invest-grid { display:grid; gap:10px; }
  .choice-card { background:#fff; border:1px solid var(--border); border-radius:10px; display:flex; justify-content:space-between; padding:12px; align-items:center; }
  .choice-left { display:flex; flex-direction:column; }
  .choice-left h4 { margin:0; font-size:15px; }
  .choice-left p { font-size:13px; color:var(--muted); }
  .btn { padding:6px 12px; border:none; border-radius:6px; background:var(--accent); color:#fff; font-weight:600; margin-left:4px; }
  .btn.info { background:#81c784; }

  /* ---------- METERS ---------- */
  .meters { margin:12px 0; }
  .meter { margin-bottom:10px; }
  .bar-bg { height:16px; background:#c8e6c9; border-radius:8px; overflow:hidden; }
  .bar-fill { height:100%; width:0%; background:var(--accent); transition: width 0.8s ease; }

  /* ---------- LOG ---------- */
  .log { max-height:120px; overflow:auto; font-size:13px; background:#fff; padding:8px; border-radius:8px; border:1px solid var(--border); margin-top:12px; }

  /* ---------- MODAL ---------- */
  .modal { display:none; position:fixed; left:50%; top:50%; transform:translate(-50%,-50%); background:#fff; border:1px solid var(--border); border-radius:12px; padding:20px; max-width:90%; max-height:80%; overflow:auto; z-index:9999; }
  .modal h3 { color:var(--accent); margin-bottom:10px; }
  .modal p { color:#333; line-height:1.4em; }
  .close-btn { margin-top:12px; background:var(--danger); color:#fff; padding:6px 12px; border:none; border-radius:6px; float:right; }

  @media(max-width:700px){
    .container { flex-direction:column; }
  }
</style>
</head>
<body>

<div class="container">
  <!-- LEFT PANEL -->
  <div class="panel">
    <h3>Portfolio</h3>
    <div class="stats">
      <div class="stat"><div>Cash</div><div class="value" id="cash">₹1000</div></div>
      <div class="stat"><div>Profit</div><div class="value" id="profit">0</div></div>
      <div class="stat"><div>Emissions</div><div class="value" id="emission">100</div></div>
      <div class="stat"><div>Food Sec</div><div class="value" id="food">50</div></div>
    </div>

    <h3>Investments</h3>
    <div class="invest-grid" id="investGrid"></div>

    <div class="log" id="logArea">Welcome! Start investing to see results.</div>
    <button class="btn" id="ruleBtn">View Rules</button>
  </div>

  <!-- RIGHT PANEL -->
  <div class="panel">
    <h3>Meters</h3>
    <div class="meters">
      <div class="meter">
        <div>Profit</div>
        <div class="bar-bg"><div class="bar-fill" id="profitBar"></div></div>
      </div>
      <div class="meter">
        <div>Emissions (lower better)</div>
        <div class="bar-bg"><div class="bar-fill" id="emissionBar"></div></div>
      </div>
      <div class="meter">
        <div>Food Security</div>
        <div class="bar-bg"><div class="bar-fill" id="foodBar"></div></div>
      </div>
    </div>
    <h3>Badge</h3>
    <div id="badge">Novice</div>
  </div>
</div>

<!-- RULES MODAL -->
<div class="modal" id="ruleModal">
  <h3>Climate Finance Simulator - Rules</h3>
  <p>1. You start with ₹1000 cash.</p>
  <p>2. Invest in projects like Solar, EV, Organic, Water, Plant-based, and more.</p>
  <p>3. Each investment affects Profit, Emissions, Food Security, and Sustainability.</p>
  <p>4. You can trigger random events that impact your portfolio.</p>
  <p>5. Complete missions and gain XP to earn badges.</p>
  <p>6. Goal: maximize Profit, reduce Emissions, and improve Food Security.</p>
  <p>7. Use diversification for best results. Watch your log for feedback!</p>
  <button class="close-btn" id="closeRules">Close</button>
</div>

<script>
  // ---------- STATE ----------
  let state = { cash:1000, profit:0, emission:100, food:50, sustain:0, xp:0, badge:'Novice' };

  const INVESTMENTS = [
    {id:'solar', name:'Solar Energy', cost:300, profit:180, emission:-28, food:6},
    {id:'ev', name:'Electric Vehicles', cost:250, profit:120, emission:-25, food:0},
    {id:'organic', name:'Organic Farming', cost:220, profit:110, emission:-12, food:22},
    {id:'water', name:'Water Recycling', cost:150, profit:90, emission:-8, food:20},
    {id:'plant', name:'Plant-Based Foods', cost:180, profit:95, emission:-30, food:18}
  ];

  const EVENTS = [
    {name:'Drought', cash:-60, emission:6, food:-22},
    {name:'Heatwave', cash:-40, emission:8, food:-12},
    {name:'Market Boom', cash:50, emission:-4, food:5}
  ];

  const log = msg => {
    const area = document.getElementById('logArea');
    const div = document.createElement('div'); div.innerText=msg;
    area.prepend(div);
  };

  function renderInvestments(){
    const grid = document.getElementById('investGrid');
    grid.innerHTML='';
    INVESTMENTS.forEach(inv=>{
      const card = document.createElement('div'); card.className='choice-card';
      card.innerHTML = `<div class="choice-left"><h4>${inv.name}</h4><p>Cost: ₹${inv.cost}</p></div>
        <div>
          <button class="btn" onclick="invest('${inv.id}')">Invest</button>
        </div>`;
      grid.appendChild(card);
    });
  }

  function updateBars(){
    document.getElementById('cash').innerText='₹'+state.cash;
    document.getElementById('profit').innerText=state.profit;
    document.getElementById('emission').innerText=state.emission;
    document.getElementById('food').innerText=state.food;

    document.getElementById('profitBar').style.width = Math.min(state.profit/300*100,100)+'%';
    document.getElementById('emissionBar').style.width = Math.min(100 - state.emission,100)+'%';
    document.getElementById('foodBar').style.width = Math.min(state.food,100)+'%';

    // Badge logic
    if(state.profit>=150 && state.food>=70) state.badge='Eco Hero';
    else if(state.profit>=80) state.badge='Intermediate';
    else state.badge='Novice';
    document.getElementById('badge').innerText=state.badge;
  }

  function invest(id){
    const inv = INVESTMENTS.find(i=>i.id===id);
    if(state.cash<inv.cost){ log('Not enough cash for '+inv.name); return; }
    state.cash -= inv.cost;
    state.profit += inv.profit;
    state.emission += inv.emission;
    state.food += inv.food;
    log(`Invested in ${inv.name}. Profit +${inv.profit}, Emission ${inv.emission}, Food +${inv.food}`);
    // 30% chance for random event
    if(Math.random()<0.3){
      const ev = EVENTS[Math.floor(Math.random()*EVENTS.length)];
      state.cash += ev.cash;
      state.emission += ev.emission;
      state.food += ev.food;
      log(`Event: ${ev.name} — Cash ${ev.cash}, Emission ${ev.emission}, Food ${ev.food}`);
    }
    updateBars();
  }

  document.getElementById('ruleBtn').addEventListener('click', ()=>document.getElementById('ruleModal').style.display='block');
  document.getElementById('closeRules').addEventListener('click', ()=>document.getElementById('ruleModal').style.display='none');

  // INIT
  renderInvestments();
  updateBars();
</script>

</body>
</html>
