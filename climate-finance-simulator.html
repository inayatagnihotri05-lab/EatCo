<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Climate Finance Simulator | EatCo</title>
<style>
:root {
  --bg: #f9f9f9;
  --panel: #ffffff;
  --green: #2e7d32;
  --green-light: #66bb6a;
  --text-dark: #333;
  --text-muted: #666;
  --border: #ddd;
  font-family: 'Inter', sans-serif;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{background:var(--bg);color:var(--text-dark);min-height:100vh;display:flex;flex-direction:column;align-items:center;font-size:14px;padding:20px 0;transition:background 0.5s;}
header{text-align:center;margin-bottom:24px;}
.logo{font-weight:700;font-size:28px;color:var(--green);}
.subtitle{color:var(--text-muted);font-size:14px;margin-top:4px;}

.status{display:flex;justify-content:center;gap:20px;margin-bottom:20px;transition:all 0.5s;}
.status div{background:var(--panel);border:1px solid var(--border);padding:6px 12px;border-radius:8px;font-weight:600;transition:all 0.3s;}

.container{display:flex;flex-direction:column;gap:20px;width:90%;max-width:900px;transition:all 0.5s;}
.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px;transition:all 0.5s;}
.card{background: var(--panel);border-radius:12px;padding:16px;border:1px solid var(--border);box-shadow:0 2px 6px rgba(0,0,0,0.05);transition:transform 0.3s, box-shadow 0.3s;position:relative;}
.card:hover{transform:translateY(-3px);box-shadow:0 4px 12px rgba(0,0,0,0.1);}
.card h3{color:var(--green);font-size:18px;margin-bottom:6px;}
.card p{color:var(--text-muted);font-size:13px;margin-bottom:12px;}
.card .btn{padding:8px 12px;border-radius:8px;border:none;cursor:pointer;font-weight:600;margin-right:6px;transition:all 0.3s;}
.btn.primary{background:var(--green);color:#fff;}
.btn.primary:hover{background:var(--green-light);}
.btn.secondary{background:#f0f0f0;color:var(--green);border:1px solid var(--green);}
.btn.secondary:hover{background:#e8f5e9;}

.meters{display:flex;flex-wrap:wrap;gap:10px;}
.meter{flex:1;min-width:120px;}
.meter h4{font-size:12px;color: var(--text-muted);margin-bottom:6px;}
.bar{height:14px;background:#e0e0e0;border-radius:8px;overflow:hidden;transition:all 0.5s;}
.bar i{display:block;height:100%;width:0%;transition:width 1s ease, background 0.5s ease;}

.log{margin-top:16px;background:#f0f0f0;border-radius:12px;max-height:200px;overflow:auto;padding:10px;font-size:13px;color:var(--text-muted);transition:all 0.5s;}

.popup{position: fixed; top:50%; left:50%; transform: translate(-50%,-50%); background: var(--panel); padding: 20px; border-radius: 12px; border: 1px solid var(--border); display: none; z-index: 999; width: 90%; max-width: 450px; transition: all 0.3s;}
.popup h3{ color: var(--green); }
.popup p{ color: var(--text-muted); margin-top:10px; }
.popup button{margin-top:10px;}
.close-row{ display:flex; justify-content:flex-end; margin-top:12px; }

.fly-icon{position:absolute;font-size:18px;animation:flyUp 1s ease forwards;pointer-events:none;}
@keyframes flyUp{0%{opacity:1;transform:translateY(0);}100%{opacity:0;transform:translateY(-40px);}}

.rules-btn{margin-bottom:10px;align-self:flex-end;}

@media(max-width:600px){.cards{grid-template-columns:1fr;}.meters{flex-direction:column;}}
</style>
</head>
<body>

<header>
  <div class="logo">EatCo</div>
  <div class="subtitle">Climate Finance Simulator - Story Mode</div>
</header>

<button class="btn secondary rules-btn" id="rulesBtn">ðŸ“– Rules</button>

<div class="status">
  <div>Cash: <span id="cash">â‚¹1000</span></div>
  <div>Mission: <span id="round">1/3</span></div>
  <div>Badge: <span id="badge">Novice</span></div>
</div>

<div class="container">
  <div class="cards" id="investGrid"></div>

  <div class="meters">
    <div class="meter">
      <h4>Profit</h4><div class="bar"><i id="profitBar"></i></div>
    </div>
    <div class="meter">
      <h4>Emissions</h4><div class="bar"><i id="emissionBar"></i></div>
    </div>
    <div class="meter">
      <h4>Food Security</h4><div class="bar"><i id="foodBar"></i></div>
    </div>
  </div>

  <div class="log" id="logArea">Welcome agent â€” complete all missions to become Eco Hero.</div>
</div>

<div class="popup" id="popup">
  <h3 id="popTitle">Title</h3>
  <p id="popBody">Body</p>
  <div class="close-row"><button class="btn secondary" id="popClose">Close</button></div>
</div>

<script>
const MISSIONS = [
  {title: "Mission 1: Solar Challenge", desc: "A sunny city wants to switch to renewable energy. Choose wisely.", options:[
    {name:'Solar Panels', cost:200, profit:100, emissions:-20, food:0, icon:'âš¡'},
    {name:'EV Fleet', cost:150, profit:80, emissions:-15, food:0, icon:'ðŸš—'},
    {name:'Community Garden', cost:100, profit:50, emissions:-5, food:15, icon:'ðŸŒ±'}
  ]},
  {title: "Mission 2: Organic Farming Boom", desc: "Farmers seek eco-friendly methods. Balance profit and food security.", options:[
    {name:'Organic Fertilizers', cost:220, profit:120, emissions:-10, food:25, icon:'ðŸŒ¾'},
    {name:'Plant-Based Foods', cost:180, profit:90, emissions:-25, food:20, icon:'ðŸ¥¬'},
    {name:'Tech Upgrade', cost:200, profit:100, emissions:-15, food:5, icon:'ðŸ’»'}
  ]},
  {title: "Mission 3: City Green Upgrade", desc: "Invest in city sustainability projects.", options:[
    {name:'Urban Trees', cost:150, profit:60, emissions:-30, food:10, icon:'ðŸŒ³'},
    {name:'Green Transport', cost:200, profit:120, emissions:-20, food:0, icon:'ðŸšŒ'},
    {name:'Eco Education', cost:100, profit:40, emissions:-5, food:5, icon:'ðŸ“š'}
  ]}
];

let state = {cash:1000, round:0, totalRounds:MISSIONS.length, profit:0, emission:100, food:50};

function $(id){return document.getElementById(id);}
function log(text){const area=$('logArea');const d=document.createElement('div');d.style.padding='4px 0';d.innerText=text;area.prepend(d);}
function showPopup(title,body){$('popTitle').innerText=title;$('popBody').innerText=body;$('popup').style.display='block';}
$('popClose').addEventListener('click',()=>{$('popup').style.display='none';});

$('rulesBtn').addEventListener('click',()=>{
  showPopup('Rules ðŸ“–', `
- You start with â‚¹1000 cash.
- Each mission lets you invest in eco-projects.
- Each project affects Profit, Emissions, and Food Security.
- Choose wisely to maximize profit & eco impact.
- Complete all missions to earn badges (Novice â†’ Intermediate â†’ Eco Hero).`);
});

function renderMission(){
  if(state.round>=MISSIONS.length){endGame(); return;}
  const mission = MISSIONS[state.round];
  $('investGrid').innerHTML='';
  mission.options.forEach(opt=>{
    const card=document.createElement('div');card.className='card';
    card.innerHTML=`<h3>${opt.name}</h3><p>Cost: â‚¹${opt.cost}</p><button class="btn primary">Invest</button>`;
    card.querySelector('button').addEventListener('click',()=>{
      invest(opt, card);
    });
    $('investGrid').appendChild(card);
  });
  log(`Mission ${state.round+1}: ${mission.desc}`);
}

function updateUI(){
  $('cash').innerText='â‚¹'+state.cash;
  $('round').innerText=(state.round+1)+'/'+state.totalRounds;
  const profitPct=Math.min(Math.max(state.profit,0),100);
  const emisPct=Math.min(Math.max(100-state.emission,0),100);
  const foodPct=Math.min(Math.max(state.food,0),100);
  $('profitBar').style.width = profitPct+'%';
  $('profitBar').style.background = '#2e7d32';
  $('emissionBar').style.width = emisPct+'%';
  $('emissionBar').style.background = '#2e7d32';
  $('foodBar').style.width = foodPct+'%';
  $('foodBar').style.background = '#2e7d32';
  let badge='Novice';
  if(state.profit>=150 && state.food>=70) badge='Eco Hero';
  else if(state.profit>=80) badge='Intermediate';
  $('badge').innerText=badge;
  const colors=['#f9f9f9','#e8f5e9','#e0f7fa'];
  document.body.style.background = colors[state.round] || '#f9f9f9';
}

function flyIcon(card, icon){
  const span=document.createElement('div');span.className='fly-icon';span.innerText=icon;
  card.appendChild(span);
  setTimeout(()=>span.remove(),1000);
}

function invest(opt, card){
  if(state.cash<opt.cost){ log('Not enough cash for '+opt.name); return; }
  state.cash -= opt.cost;
  state.profit += opt.profit/10;
  state.emission += opt.emissions/10;
  state.food += opt.food/10;
  log(`Invested â‚¹${opt.cost} in ${opt.name} â†’ Profit +${opt.profit}`);
  flyIcon(card,opt.icon);
  state.round++;
  updateUI();
  renderMission();
}

function endGame(){
  showPopup('ðŸŽ‰ All Missions Completed!','Final Cash: â‚¹'+state.cash+'\nProfit: '+state.profit+'\nFood Security: '+state.food+'\nBadge: '+$('badge').innerText);
  log('Game finished! Refresh to play again.');
}

updateUI();
renderMission();
</script>

</body>
</html>
