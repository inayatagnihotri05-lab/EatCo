<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Climate Finance Simulator | EatCo</title>
<style>
:root {
  --bg: #f9f9f9;
  --panel: #ffffff;
  --green: #2e7d32;
  --green-light: #66bb6a;
  --orange: #ff9800;
  --red: #e53935;
  --text-dark: #333;
  --text-muted: #666;
  --border: #ddd;
  font-family: 'Inter', sans-serif;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{background:var(--bg);color:var(--text-dark);min-height:100vh;display:flex;flex-direction:column;align-items:center;font-size:14px;padding:20px 0;}

header{text-align:center;margin-bottom:24px;}
.logo{font-weight:700;font-size:28px;color:var(--green);}
.subtitle{color:var(--text-muted);font-size:14px;margin-top:4px;}

.status{display:flex;justify-content:center;gap:20px;margin-bottom:20px;}
.status div{background:var(--panel);border:1px solid var(--border);padding:6px 12px;border-radius:8px;font-weight:600;}

.container{display:flex;flex-direction:column;gap:20px;width:90%;max-width:900px;}
.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px;}
.card{background: var(--panel);border-radius:12px;padding:16px;border:1px solid var(--border);box-shadow:0 2px 6px rgba(0,0,0,0.05);}
.card h3{color:var(--green);font-size:18px;margin-bottom:6px;}
.card p{color:var(--text-muted);font-size:13px;margin-bottom:12px;}
.card .btn{padding:8px 12px;border-radius:8px;border:none;cursor:pointer;font-weight:600;margin-right:6px;}
.btn.primary{background:var(--green);color:#fff;}
.btn.secondary{background:#f0f0f0;color:var(--green);border:1px solid var(--green);}

.meters{display:flex;flex-wrap:wrap;gap:10px;}
.meter{flex:1;min-width:120px;}
.meter h4{font-size:12px;color: var(--text-muted);margin-bottom:6px;}
.bar{height:14px;background:#e0e0e0;border-radius:8px;overflow:hidden;}
.bar i{display:block;height:100%;width:0%;transition:width 0.7s ease;}

.log{margin-top:16px;background:#f0f0f0;border-radius:12px;max-height:200px;overflow:auto;padding:10px;font-size:13px;color:var(--text-muted);}

.popup{position: fixed; top:50%; left:50%; transform: translate(-50%,-50%); background: var(--panel); padding: 20px; border-radius: 12px; border: 1px solid var(--border); display: none; z-index: 999; width: 90%; max-width: 450px;}
.popup h3{ color: var(--green); }
.popup p{ color: var(--text-muted); margin-top:10px; }
.close-row{ display:flex; justify-content:flex-end; margin-top:12px; }

@media(max-width:600px){.cards{grid-template-columns:1fr;}.meters{flex-direction:column;}}
</style>
</head>
<body>

<header>
  <div class="logo">EatCo</div>
  <div class="subtitle">Climate Finance Simulator</div>
</header>

<div class="status">
  <div>Cash: <span id="cash">₹1000</span></div>
  <div>Round: <span id="round">1/5</span></div>
  <div>Badge: <span id="badge">Novice</span></div>
</div>

<div class="container">
  <div class="cards" id="investGrid"></div>

  <div class="meters">
    <div class="meter">
      <h4>Profit</h4><div class="bar"><i id="profitBar"></i></div>
    </div>
    <div class="meter">
      <h4>Emissions</h4><div class="bar"><i id="emissionBar"></i></div>
    </div>
    <div class="meter">
      <h4>Food Security</h4><div class="bar"><i id="foodBar"></i></div>
    </div>
  </div>

  <div class="log" id="logArea">Welcome agent — allocate wisely.</div>
</div>

<div class="popup" id="popup">
  <h3 id="popTitle">Title</h3>
  <p id="popBody">Body</p>
  <div class="close-row"><button class="btn secondary" id="popClose">Close</button></div>
</div>

<script>
const INVESTMENTS = [
  {id:'solar', name:'Solar Energy', baseCost:300, profit:180, emissions:-28, food:6, info:'Steady ROI from solar projects.'},
  {id:'ev', name:'Electric Vehicles', baseCost:250, profit:120, emissions:-25, food:0, info:'Medium-term growth potential.'},
  {id:'organic', name:'Organic Farming', baseCost:220, profit:110, emissions:-12, food:22, info:'Supports soil & yield.'},
  {id:'plant', name:'Plant-Based Foods', baseCost:180, profit:95, emissions:-30, food:18, info:'Growing demand & sustainability.'}
];

const EVENTS = [
  {text:'Tech breakthrough increases solar ROI!', profit:50, emissions:-5, food:0},
  {text:'Market fluctuation reduces EV returns!', profit:-40, emissions:0, food:0},
  {text:'Organic yield boost!', profit:20, emissions:-2, food:10},
  {text:'Plant food demand drops!', profit:-15, emissions:0, food:-5}
];

let state = {cash:1000, round:1, totalRounds:5, profit:0, emission:100, food:50, xp:0};

function $(id){return document.getElementById(id);}
function log(text){const area=$('logArea');const d=document.createElement('div');d.style.padding='4px 0';d.innerText=text;area.prepend(d);}
function showPopup(title,body){$('popTitle').innerText=title;$('popBody').innerText=body;$('popup').style.display='block';}
$('popClose').addEventListener('click',()=>{$('popup').style.display='none';});

function renderCards(){
  const container = $('investGrid');
  container.innerHTML='';
  INVESTMENTS.forEach(inv=>{
    const card=document.createElement('div');card.className='card';
    card.innerHTML=`<h3>${inv.name}</h3><p>Cost: ₹${inv.baseCost}</p>
    <button class="btn primary" data-id="${inv.id}">Invest</button>
    <button class="btn secondary" data-info="${inv.id}">Info</button>`;
    container.appendChild(card);
  });
  document.querySelectorAll('.card .btn[data-id]').forEach(b=>b.addEventListener('click',e=>invest(e.currentTarget.dataset.id)));
  document.querySelectorAll('.card .btn[data-info]').forEach(b=>b.addEventListener('click',e=>{
    const inv=INVESTMENTS.find(x=>x.id===e.currentTarget.dataset.info);
    showPopup(inv.name,inv.info);
  }));
}

function updateUI(){
  $('cash').innerText='₹'+state.cash;
  $('round').innerText=state.round+'/'+state.totalRounds;
  const profitPct=Math.min(Math.max(state.profit,0),100);
  const emisPct=Math.min(Math.max(100-state.emission,0),100);
  const foodPct=Math.min(Math.max(state.food,0),100);

  $('profitBar').style.width=profitPct+'%';
  $('emissionBar').style.width=emisPct+'%';
  $('foodBar').style.width=foodPct+'%';

  // Update badge
  let badge='Novice';
  if(state.profit>=150 && state.food>=70) badge='Eco Hero';
  else if(state.profit>=80) badge='Intermediate';
  $('badge').innerText=badge;
}

function invest(id){
  if(state.round>state.totalRounds){ log('Game over! Refresh to play again.'); return; }
  const inv=INVESTMENTS.find(x=>x.id===id);
  if(state.cash<inv.baseCost){ log('Not enough cash for '+inv.name); return; }

  // Deduct cost
  state.cash -= inv.baseCost;

  // Base returns
  state.profit += inv.profit/10;
  state.emission += inv.emissions/10;
  state.food += inv.food/10;

  log(`Round ${state.round}: Invested ₹${inv.baseCost} in ${inv.name} → Profit +${inv.profit}`);

  // Random event chance
  if(Math.random()<0.3){
    const ev=EVENTS[Math.floor(Math.random()*EVENTS.length)];
    state.profit += (ev.profit||0)/10;
    state.emission += (ev.emissions||0)/10;
    state.food += (ev.food||0)/10;
    log('EVENT: '+ev.text);
  }

  state.round++;
  updateUI();

  if(state.round>state.totalRounds){
    endGame();
  }
}

function endGame(){
  const topInvest = INVESTMENTS.reduce((max,i)=>i.profit>max.profit?i:max,INVESTMENTS[0]);
  showPopup('Game Over!','Final Cash: ₹'+state.cash+'\nProfit: '+state.profit+'\nFood Security: '+state.food+'\nTop Investment: '+topInvest.name);
  log('Game finished! Final stats above.');
}

renderCards();
updateUI();
log('Simulator ready. Click investments to start.');
</script>

</body>
</html>
